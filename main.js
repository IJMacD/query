!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){function n(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var a=document.getElementById("input"),r=document.getElementById("output"),o=document.getElementById("query-form"),c=document.getElementById("query-suggest"),i=document.getElementById("explorer"),l=document.getElementById("explorer-toggle"),u="query_history",s=20,d=100,f=function(){var e=localStorage.getItem(u);if(e)try{return JSON.parse(e)}catch(e){}return[]}(),p=!1,h=!0;function m(){if(location.hash&&!a.disabled){var e=new URLSearchParams(location.hash.substr(1));e.has("q")&&(a.value=e.get("q"),g())}}function g(){b(),r.innerHTML="",a.disabled=!0;var e=Date.now();location.hash="#q="+encodeURIComponent(a.value),document.title="Query: "+a.value,query(a.value).then(function(t){var o,c,i=(Date.now()-e)/1e3;if(o=a.value,(f=f.filter(function(e){return e!==o})).unshift(a.value),f.length=d,localStorage.setItem(u,JSON.stringify(f)),2!==t.length||"AST"!==t[0][0]){if(r.innerHTML=function(e){var t=e.rows,n=e.duration,a=t.shift();if(!a)return'<p style="font-weight: bold;">Empty Result Set</p><p>'.concat(n," seconds</p>");return"<table>\n            <thead>\n                <tr>".concat(a.map(function(e){return"<th>".concat(e,"</th>")}).join(""),"</tr>\n            </thead>\n            <tbody>\n                ").concat(t.map(function(e){return"\n                    <tr>".concat(e.map(function(e){return"<td>".concat(function(e){var t=e.cell;if(null===t)return'<span class="null"></span>';if(t instanceof Date)return function(e){if(0===e.getHours()&&0===e.getMinutes())return e.toLocaleDateString(navigator.language);return e.toLocaleString(navigator.language)}(t);var n=String(t);h&&n.includes("<")&&(a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},n=n.replace(/[&<>"']/g,function(e){return a[e]}));var a;if(/^#[0-9a-f]{6}$/i.test(n))return'<div style="background-color: '.concat(n,'; height: 20px; width: 20px; margin: 0 auto;" title="').concat(n,'"></div>');n.includes("<")||(n=(n=n.replace(/https?:\/\/[^,'>" &()[\]]+/g,function(e){var t=e;return/\.(jpe?g|gif|png|webp)$/i.test(e)&&(t=p?'<object data="'.concat(e,'" height="64"></object>'):'<img src="'.concat(e,'" height="64" />')),'<a href="'.concat(e,'" target="_blank">').concat(t,"</a>")})).replace(/[^@,\s]+@[^@,\s]+\.[^@,\s]+/g,function(e){return'<a href="mailto:'.concat(e,'">').concat(e,"</a>")}));return n}({cell:e}),"</td>")}).join(""),"</tr>\n                ")}).join(""),'\n            </tbody>\n            <tfoot><tr><td colspan="').concat(a.length,'">').concat(t.length," rows, ").concat(n," seconds</td></tr></tfoot>\n        </table>")}({rows:t.slice(),duration:i}),t.length>=3&&t[0].length>=2&&"number"==typeof t[1][0]&&"number"==typeof t[1][1]){var l=r.querySelector("tfoot td");if(l){var s=document.createElement("button");s.className="link",s.innerHTML="Graph",s.addEventListener("click",function(){l.removeChild(s),r.appendChild(function(e){var t=document.createElement("canvas"),a=t.getContext("2d");t.width=300,t.height=300;e.shift();var r=e.map(function(e){return e[0]}),o=e.map(function(e){return e[1]}),c=Math.min.apply(Math,n(r)),i=Math.max.apply(Math,n(r)),l=Math.min.apply(Math,n(o)),u=Math.max.apply(Math,n(o)),s=t.width/(i-c),d=t.height/(u-l),f=t.height;a.strokeStyle="#999",a.strokeRect(0,0,t.width,t.height),a.beginPath(),a.moveTo((r[0]-c)*s,f-(o[0]-l)*d);for(var p=1;p<e.length;p++)a.lineTo((r[p]-c)*s,f-(o[p]-l)*d);return a.strokeStyle="red",a.stroke(),t}(t.slice()))}),l.appendChild(s)}}}else r.innerHTML=(c=t[1][0],function e(t){var n={UNKNOWN:0,STATEMENT:1,CLAUSE:2,FUNCTION_CALL:3,SYMBOL:4,STRING:5,NUMBER:6,OPERATOR:7,LIST:8,COMPOUND_QUERY:9},a=Object.keys(n),r=a[t.type].toLowerCase().replace(/[ _]/g,"-"),o=String(null!==t.id?t.id:t.type===n.LIST?"LIST":""),c=o.toLowerCase().replace(/[ _]/g,"-");return'<div class="node-type-'.concat(r," node-id-").concat(c,'" title="').concat(t.source.replace(/"/g,"&quot;"),'">\n        <span class="node-id">').concat(o,"</span>\n        ").concat(Array.isArray(t.children)?"<ul>".concat(t.children.map(function(t){return"<li>".concat(t.alias?'<span class="node-alias">'.concat(t.alias,"</span>"):"").concat(e(t),"</li>")}).join(""),"</ul>"):"","\n    </div>")}(JSON.parse(c)))}).catch(function(e){r.innerHTML='<p style="color: red; margin: 20px;">'.concat(e,"</p>")}).then(function(){a.disabled=!1})}function v(){return f.filter(function(e){return e&&e!=a.value&&e.startsWith(a.value)}).slice(0,s)}function y(){c.innerHTML=v().map(function(e){return"<li>".concat(e,"</li>")}).join("")}function b(){c.innerHTML=""}m(),a.focus(),function e(){var t=document.getElementById("explorer");t.innerHTML="";var n=document.createElement("button");n.innerText="Refresh";n.addEventListener("click",e);t.appendChild(n);var r=document.createElement("label");var o=document.createElement("input");o.type="checkbox";r.appendChild(o);r.appendChild(document.createTextNode("Browse"));t.appendChild(r);t.addEventListener("click",function(e){if(e.target instanceof HTMLLIElement){var t=a.value,n=a.selectionStart,r=a.selectionEnd,c=e.target.dataset,i=c.insert,l=c.insertBefore,u=void 0===l?"":l,s=c.insertAfter,d=void 0===s?"":s;if(o.checked&&i)return a.value="FROM ".concat(i),void g();var f=t.substring(0,n),p=t.substring(n,r),h=t.substring(r),m=i||p;a.value=f+u+m+d+h,n+=u.length,""===p?(n+=m.length,r=n):r=n+m.length,a.setSelectionRange(n,r),a.focus()}});var c=document.createElement("h2");c.innerText="Tables";t.appendChild(c);var i=document.createElement("ul");t.appendChild(i);query("FROM information_schema.tables\n        SELECT table_schema, table_name, table_type\n        UNION ALL\n        FROM information_schema.routines\n        WHERE data_type = 'table'\n        SELECT null, routine_name, 'table function'").then(function(e){e.shift();var t=e.map(function(e){if("table function"===e[2]){var t="".concat(e[1],"(");return'<li class="'.concat("table-function",'" data-insert-before="').concat(t,'" data-insert-after="').concat(")",'" title="TABLE VALUED FUNCTION">').concat(e[0]?e[0]+".":"").concat(e[1],"</li>")}var n=e[2].includes("VIEW")?"view":"table",a="".concat(e[0]?e[0]+".":"").concat(e[1]);return'<li class="'.concat(n,'" data-insert="').concat(a,'" title="').concat(e[2],'">').concat(a,"</li>")}).join("");i.innerHTML=t});var l=document.createElement("h2");l.innerText="Functions";t.appendChild(l);var u=document.createElement("ul");t.appendChild(u);query("FROM information_schema.routines WHERE data_type != 'table'").then(function(e){var t=e.shift(),n=t.indexOf("routine_name"),a=t.indexOf("routine_type"),r=e.map(function(e){var t="AGGREGATE FUNCTION"===e[a]||"WINDOW FUNCTION"===e[a]?"aggregate-function":"function";return'<li class="'.concat(t,'" data-insert-before="').concat(e[n],'(" data-insert-after=")" title="').concat(e[a],'">').concat(e[n],"</li>")}).join("");u.innerHTML=r})}(),o.addEventListener("submit",function(e){e.preventDefault(),g()}),document.addEventListener("keydown",function(e){if("Enter"===e.key)g();else if("Escape"===e.key)b();else if("Tab"===e.key){var t=v();t.length>=1&&(e.preventDefault(),a.value=t[0])}}),document.addEventListener("click",function(e){b()}),a.addEventListener("keyup",function(e){if(e.altKey&&"1234567890".includes(e.key)){e.preventDefault();var t=v()["1234567890".indexOf(e.key)];void 0!==t&&(a.value=t)}else if("Escape"===e.key)return;y()}),c.addEventListener("click",function(e){e.target instanceof HTMLLIElement&&(a.value=e.target.textContent,y(),a.focus())}),window.addEventListener("hashchange",m),i.style.display="none",l.addEventListener("click",function(){i.style.display="none"===i.style.display?"block":"none"})}]);