!function(t){var e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e){function n(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var a=document.getElementById("input"),r=document.getElementById("output"),o=document.getElementById("query-form"),i=document.getElementById("query-suggest"),c=document.getElementById("explorer"),l=document.getElementById("explorer-toggle"),u="query_history",s=20,f=100,d=function(){var t=localStorage.getItem(u);if(t)try{return JSON.parse(t)}catch(t){}return[]}(),p=!1,g=!0;function h(){if(location.hash&&!a.disabled){var t=new URLSearchParams(location.hash.substr(1));t.has("q")&&(a.value=t.get("q"),m())}}function m(){L(),r.innerHTML="",a.disabled=!0;var t=Date.now();location.hash="#q="+encodeURIComponent(a.value),document.title="Query: "+a.value,query(a.value).then(function(e){var o,i,c=(Date.now()-t)/1e3;if(o=a.value,(d=d.filter(function(t){return t!==o})).unshift(a.value),d.length=f,localStorage.setItem(u,JSON.stringify(d)),2!==e.length||"AST"!==e[0][0]){if(r.innerHTML=function(t){var e=t.rows,n=t.duration,a=e.shift();if(!a)return'<p style="font-weight: bold;">Empty Result Set</p><p>'.concat(n," seconds</p>");return"<table>\n            <thead>\n                <tr>".concat(a.map(function(t){return"<th>".concat(t,"</th>")}).join(""),"</tr>\n            </thead>\n            <tbody>\n                ").concat(e.map(function(t){return"\n                    <tr>".concat(t.map(function(t){return"<td>".concat(function(t){var e=t.cell;if(null===e)return'<span class="null"></span>';if(e instanceof Date)return function(t){if(0===t.getHours()&&0===t.getMinutes())return t.toLocaleDateString(navigator.language);return t.toLocaleString(navigator.language)}(e);var n=String(e);g&&n.includes("<")&&(a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},n=n.replace(/[&<>"']/g,function(t){return a[t]}));var a;if(/^#[0-9a-f]{6}$/i.test(n))return'<div style="background-color: '.concat(n,'; height: 20px; width: 20px; margin: 0 auto;" title="').concat(n,'"></div>');n.includes("<")||(n=(n=n.replace(/https?:\/\/[^,'>" &()[\]]+/g,function(t){var e=t;return/\.(jpe?g|gif|png|webp)$/i.test(t)&&(e=p?'<object data="'.concat(t,'" height="64"></object>'):'<img src="'.concat(t,'" height="64" />')),'<a href="'.concat(t,'" target="_blank">').concat(e,"</a>")})).replace(/[^@,\s]+@[^@,\s]+\.[^@,\s]+/g,function(t){return'<a href="mailto:'.concat(t,'">').concat(t,"</a>")}));return n}({cell:t}),"</td>")}).join(""),"</tr>\n                ")}).join(""),'\n            </tbody>\n            <tfoot><tr><td colspan="').concat(a.length,'">').concat(e.length," rows, ").concat(n," seconds</td></tr></tfoot>\n        </table>")}({rows:e.slice(),duration:c}),e.length>=3&&e[0].length>=2&&"number"==typeof e[1][0]&&"number"==typeof e[1][1]){var l=r.querySelector("tfoot td");if(l){var s=document.createElement("button");s.className="link",s.innerHTML="Graph",s.addEventListener("click",function(){l.removeChild(s),r.appendChild(function(t){var e=document.createElement("canvas"),a=e.getContext("2d");e.width=300,e.height=300;t.shift();var r=t.map(function(t){return t[0]}),o=t.map(function(t){return t[1]}),i=Math.min.apply(Math,n(r)),c=Math.max.apply(Math,n(r)),l=Math.min.apply(Math,n(o)),u=Math.max.apply(Math,n(o)),s=e.width/(c-i),f=e.height/(u-l),d=e.height;a.strokeStyle="#999",a.strokeRect(0,0,e.width,e.height),a.beginPath(),a.moveTo((r[0]-i)*s,d-(o[0]-l)*f);for(var p=1;p<t.length;p++)a.lineTo((r[p]-i)*s,d-(o[p]-l)*f);return a.strokeStyle="red",a.stroke(),e}(e.slice()))}),l.appendChild(s)}}}else r.innerHTML=(i=e[1][0],function t(e){var n=v[e.type].toLowerCase().replace(/[ _]/g,"-"),a=String(null!==e.id?e.id:e.type===y.LIST?"LIST":""),r=a.toLowerCase().replace(/[ _]/g,"-");return'<div class="node-type-'.concat(n," node-id-").concat(r,'" title="').concat(e.source.replace(/"/g,"&quot;"),'">\n        <span class="node-id">').concat(a,"</span>\n        ").concat(Array.isArray(e.children)?"<ul>".concat(e.children.map(function(e){return"<li>".concat(e.alias?'<span class="node-alias">'.concat(e.alias,"</span>"):"").concat(t(e),"</li>")}).join(""),"</ul>"):"","\n    </div>")}(JSON.parse(i)))}).catch(function(t){r.innerHTML='<p style="color: red; margin: 20px;">'.concat(t,"</p>")}).then(function(){a.disabled=!1})}h(),a.focus(),document.getElementById("explorer").addEventListener("click",function(t){if(t.target instanceof HTMLLIElement){var e=a.value,n=a.selectionStart,r=a.selectionEnd,o=t.target.dataset,i=o.insert,c=o.insertBefore,l=void 0===c?"":c,u=o.insertAfter,s=void 0===u?"":u,f=e.substring(0,n),d=e.substring(n,r),p=e.substring(r),g=i||d;a.value=f+l+g+s+p,n+=l.length,""===d?(n+=g.length,r=n):r=n+g.length,a.setSelectionRange(n,r),a.focus()}}),query("FROM information_schema.tables\n        SELECT table_schema, table_name, table_type\n        UNION ALL\n        FROM information_schema.routines\n        WHERE data_type = 'table'\n        SELECT null, routine_name, 'table function'").then(function(t){t.shift();var e=t.map(function(t){if("table function"===t[2]){var e="".concat(t[1],"(");return'<li class="'.concat("table-function",'" data-insert-before="').concat(e,'" data-insert-after="').concat(")",'" title="TABLE VALUED FUNCTION">').concat(t[0]?t[0]+".":"").concat(t[1],"</li>")}var n=t[2].includes("VIEW")?"view":"table",a="information_schema"===t[0]?"".concat(t[0],".").concat(t[1]):t[1];return'<li class="'.concat(n,'" data-insert="').concat(a,'" title="').concat(t[2],'">').concat(t[0]?t[0]+".":"").concat(t[1],"</li>")}).join("");document.getElementById("explorer-table-list").innerHTML=e}),query("FROM information_schema.routines WHERE data_type != 'table'").then(function(t){var e=t.shift(),n=e.indexOf("routine_name"),a=e.indexOf("routine_type"),r=t.map(function(t){var e="AGGREGATE FUNCTION"===t[a]||"WINDOW FUNCTION"===t[a]?"aggregate-function":"function";return'<li class="'.concat(e,'" data-insert-before="').concat(t[n],'(" data-insert-after=")" title="').concat(t[a],'">').concat(t[n],"</li>")}).join("");document.getElementById("explorer-function-list").innerHTML=r}),o.addEventListener("submit",function(t){t.preventDefault(),m()}),document.addEventListener("keydown",function(t){if("Enter"===t.key)m();else if("Escape"===t.key)L();else if("Tab"===t.key){var e=b();e.length>=1&&(t.preventDefault(),a.value=e[0])}}),document.addEventListener("click",function(t){L()}),a.addEventListener("keyup",function(t){if(t.altKey&&"1234567890".includes(t.key)){t.preventDefault();var e=b()["1234567890".indexOf(t.key)];void 0!==e&&(a.value=e)}else if("Escape"===t.key)return;E()}),i.addEventListener("click",function(t){t.target instanceof HTMLLIElement&&(a.value=t.target.textContent,E(),a.focus())}),window.addEventListener("hashchange",h),c.style.display="none",l.addEventListener("click",function(){c.style.display="none"===c.style.display?"block":"none"});var y={UNKNOWN:0,STATEMENT:1,CLAUSE:2,FUNCTION_CALL:3,SYMBOL:4,STRING:5,NUMBER:6,OPERATOR:7,LIST:8},v=["UNKNOWN","STATEMENT","CLAUSE","FUNCTION_CALL","SYMBOL","STRING","NUMBER","OPERATOR","LIST"];function b(){return d.filter(function(t){return t&&t!=a.value&&t.startsWith(a.value)}).slice(0,s)}function E(){i.innerHTML=b().map(function(t){return"<li>".concat(t,"</li>")}).join("")}function L(){i.innerHTML=""}}]);